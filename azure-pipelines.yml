jobs: 
- task: AzureWebApp@1
  inputs:
    azureSubscription: 'Azure for Students (6e9408e7-a3a5-44d0-80f3-65b13b7b59a9)'
    appType: 'webAppLinux'
    appName: 'Webapp'
    deployToSlotOrASE: true
    resourceGroupName: 'resource'
    slotName: 'production'
    package: '$(System.DefaultWorkingDirectory)/**/*.zip'
    runtimeStack: 'STATICSITE|1.0'
    startUpCommand: 'run'
- deployment: VMDeploy
  displayName: web
  environment: server
    name: server
    resourceType: VirtualMachine
  strategy:
      rolling:
        maxParallel: 5  #for percentages, mention as x%
        preDeploy:
          steps:
          - download: current
            artifact: drop
          - script: echo initialize, cleanup, backup, install certs
        deploy:
          steps:
          - task: Bash@3
            inputs:
              targetType: 'inline'
              script: |
                # Modify deployment script based on the app type
                echo "Starting deployment script run"
                sudo java -jar '$(Pipeline.Workspace)/drop/**/target/*.jar'
        routeTraffic:
          steps:
          - script: echo routing traffic
        postRouteTraffic:
          steps:
          - script: echo health check post-route traffic
        on:
          failure:
            steps:
            - script: echo Restore from backup! This is on failure
          success:
            steps:
            - script: echo Notify! This is on success
